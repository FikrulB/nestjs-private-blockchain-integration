generator client {
  provider        = "prisma-client-js"
  binaryTargets   = ["native", "linux-musl-arm64-openssl-3.0.x", "linux-musl-openssl-3.0.x"]
  engineType      = "node"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DB_URL")
  extensions = [uuidOssp(map: "uuid-ossp")]
}

model Users {
  id               String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  fullName         String           @map("full_name") @db.VarChar(255)
  email            String           @unique @db.VarChar(100)
  emailVerifiedAt  DateTime?        @map("email_verified_at")
  password         String           @db.VarChar(60)
  accountBcAddress String           @unique @map("account_bc_address") @db.Char(42)
  status           Boolean          @default(true)
  createdBy        String?          @map("created_by")
  createdAt        DateTime         @default(now()) @map("created_at")
  updatedBy        String?          @map("updated_by")
  updatedAt        DateTime?        @updatedAt @map("updated_at")
  deletedBy        String?          @map("deleted_by")
  deletedAt        DateTime?        @map("deleted_at")
  // Relations
  LogActivity      LogActivities[]
  LogManagements   LogManagements[]
  UserRoleAccess   UserRoleAccess[]

  @@map("users")
}

model UserRoleAccess {
  id       String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  userID   String   @map("user_id") @db.Uuid
  role     Roles
  clientID String?  @map("client_id") @db.Uuid
  // Relations
  User     Users    @relation(fields: [userID], references: [id])
  Client   Clients? @relation(fields: [clientID], references: [id])

  @@map("user_role_access")
}

model Clients {
  id             String           @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name           String           @db.VarChar(255)
  contactEmail   String           @map("contact_email") @db.VarChar(255)
  contactPhone   String           @map("contact_phone") @db.VarChar(255)
  createdBy      String           @map("created_by")
  createdAt      DateTime         @default(now()) @map("created_at")
  updatedBy      String?          @map("updated_by")
  updatedAt      DateTime?        @updatedAt @map("updated_at")
  // Relations
  ApiManagements ApiManagements[]
  UserRoleAccess UserRoleAccess[]

  @@map("clients")
}

model ApiManagements {
  id        String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  apiKey    String    @unique @map("api_key") @db.Char(64)
  clientID  String    @map("client_id") @db.Uuid
  startAt   DateTime? @map("start_at")
  endAt     DateTime? @map("end_at")
  createdBy String?   @map("created_by")
  createdAt DateTime  @default(now()) @map("created_at")
  updatedBy String?   @map("updated_by")
  updatedAt DateTime? @updatedAt @map("updated_at")
  deletedBy String?   @map("deleted_by")
  deletedAt DateTime? @map("deleted_at")
  // Relations
  Client    Clients   @relation(fields: [clientID], references: [id])

  @@map("api_managements")
}

model LogActivities {
  id        String   @id @default(uuid()) @db.Uuid
  activity  String   @db.VarChar(100)
  userAgent String?  @map("user_agent") @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at")
  createdBy String   @map("created_by") @db.Uuid
  // Relations
  Users     Users    @relation(fields: [createdBy], references: [id])

  @@map("log_activities")
}

model LogManagements {
  id               String   @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  activity         String   @db.VarChar(100)
  accountBcAddress String   @map("account_bc_address") @db.Char(42)
  userEmail        String   @map("user_email") @db.VarChar
  userAgent        String   @map("user_agent") @db.VarChar
  userIP           String   @map("user_ip") @db.VarChar
  data             Json     @map("data")
  interactTo       String   @map("interact_to") @db.VarChar
  txHash           String   @map("tx_hash") @db.VarChar
  createdBy        String   @map("created_by") @db.Uuid
  createdAt        DateTime @default(now()) @map("created_at")
  // Relations
  Users            Users    @relation(fields: [createdBy], references: [id])

  @@map("log_managements")
}

enum Roles {
  OWNER
  ADMIN
  USER
}
